#!/usr/bin/env bash
set -euo pipefail

# Auto-format staged .go files with gofmt and re-stage them.
staged_go_files=$(git diff --cached --name-only --diff-filter=ACM | grep '\.go$' || true)

if [ -z "$staged_go_files" ]; then
  exit 0
fi

echo "gofmt: formatting staged Go files..."
for f in $staged_go_files; do
  if [ -f "$f" ]; then
    gofmt -w "$f"
    git add "$f"
  fi
done
